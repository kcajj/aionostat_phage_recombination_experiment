[2023-08-29 14:05:10] root: INFO: Starting Flye 2.9.2-b1786
[2023-08-29 14:05:10] root: DEBUG: Cmd: /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/bin/flye --nano-hq data/nanopore/P2_C3.fastq.gz --out-dir results/assemblies/P2/C3_flye --threads 4 --genome-size 0.150m --asm-coverage 40
[2023-08-29 14:05:10] root: DEBUG: Python version: 3.9.16 (main, May 15 2023, 23:46:34) 
[GCC 11.2.0]
[2023-08-29 14:05:10] root: INFO: >>>STAGE: configure
[2023-08-29 14:05:10] root: INFO: Configuring run
[2023-08-29 14:06:03] root: INFO: Total read length: 850958223
[2023-08-29 14:06:03] root: INFO: Input genome size: 150000
[2023-08-29 14:06:03] root: INFO: Estimated coverage: 5673
[2023-08-29 14:06:03] root: WARNING: Expected read coverage is 5673, the assembly is not guaranteed to be optimal in this setting. Are you sure that the genome size was entered correctly?
[2023-08-29 14:06:03] root: INFO: Reads N50/N90: 8098 / 2100
[2023-08-29 14:06:03] root: INFO: Minimum overlap set to 2000
[2023-08-29 14:06:03] root: INFO: Using longest 40x reads for contig assembly
[2023-08-29 14:06:03] root: DEBUG: Min read length cutoff: 50352
[2023-08-29 14:06:03] root: INFO: >>>STAGE: assembly
[2023-08-29 14:06:03] root: INFO: Assembling disjointigs
[2023-08-29 14:06:03] root: DEBUG: -----Begin assembly log------
[2023-08-29 14:06:03] root: DEBUG: Running: flye-modules assemble --reads /home/giacomocastagnetti/code/rec_genome_analysis/data/nanopore/P2_C3.fastq.gz --out-asm /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/00-assembly/draft_assembly.fasta --config /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_nano_hq.cfg --log /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/flye.log --threads 4 --genome-size 150000 --min-ovlp 2000 --min-read 50352
[2023-08-29 14:06:03] DEBUG: Build date: May 16 2023 07:05:14
[2023-08-29 14:06:03] DEBUG: Total RAM: 31 Gb
[2023-08-29 14:06:03] DEBUG: Available RAM: 23 Gb
[2023-08-29 14:06:03] DEBUG: Total CPUs: 8
[2023-08-29 14:06:03] DEBUG: Loading /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_nano_hq.cfg
[2023-08-29 14:06:03] DEBUG: Loading /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_defaults.cfg
[2023-08-29 14:06:03] DEBUG: 	big_genome_threshold=29000000
[2023-08-29 14:06:03] DEBUG: 	meta_read_filter_kmer_freq=100
[2023-08-29 14:06:03] DEBUG: 	chain_large_gap_penalty=2
[2023-08-29 14:06:03] DEBUG: 	chain_small_gap_penalty=0.5
[2023-08-29 14:06:03] DEBUG: 	chain_gap_jump_threshold=100
[2023-08-29 14:06:03] DEBUG: 	max_coverage_drop_rate=5
[2023-08-29 14:06:03] DEBUG: 	max_extensions_drop_rate=5
[2023-08-29 14:06:03] DEBUG: 	chimera_window=100
[2023-08-29 14:06:03] DEBUG: 	chimera_overhang=1000
[2023-08-29 14:06:03] DEBUG: 	min_reads_in_disjointig=4
[2023-08-29 14:06:03] DEBUG: 	max_inner_reads=10
[2023-08-29 14:06:03] DEBUG: 	max_inner_fraction=0.25
[2023-08-29 14:06:03] DEBUG: 	max_separation=500
[2023-08-29 14:06:03] DEBUG: 	unique_edge_length=50000
[2023-08-29 14:06:03] DEBUG: 	min_repeat_res_support=0.51
[2023-08-29 14:06:03] DEBUG: 	out_paths_ratio=5
[2023-08-29 14:06:03] DEBUG: 	graph_cov_drop_rate=5
[2023-08-29 14:06:03] DEBUG: 	coverage_estimate_window=100
[2023-08-29 14:06:03] DEBUG: 	max_bubble_length=50000
[2023-08-29 14:06:03] DEBUG: 	loop_coverage_rate=1.5
[2023-08-29 14:06:03] DEBUG: 	repeat_edge_cov_mult=1.75
[2023-08-29 14:06:03] DEBUG: 	weak_detach_rate=5
[2023-08-29 14:06:03] DEBUG: 	tip_coverage_rate=2
[2023-08-29 14:06:03] DEBUG: 	tip_length_rate=2
[2023-08-29 14:06:03] DEBUG: 	output_gfa_before_rr=0
[2023-08-29 14:06:03] DEBUG: 	remove_alt_edges=0
[2023-08-29 14:06:03] DEBUG: 	low_cutoff_warning=0
[2023-08-29 14:06:03] DEBUG: 	kmer_size=17
[2023-08-29 14:06:03] DEBUG: 	use_minimizers=1
[2023-08-29 14:06:03] DEBUG: 	minimizer_window=5
[2023-08-29 14:06:03] DEBUG: 	reads_base_alignment=1
[2023-08-29 14:06:03] DEBUG: 	meta_read_top_kmer_rate=0.75
[2023-08-29 14:06:03] DEBUG: 	maximum_jump=1500
[2023-08-29 14:06:03] DEBUG: 	maximum_overhang=1500
[2023-08-29 14:06:03] DEBUG: 	repeat_kmer_rate=100
[2023-08-29 14:06:03] DEBUG: 	assemble_ovlp_divergence=0.05
[2023-08-29 14:06:03] DEBUG: 	assemble_divergence_relative=1
[2023-08-29 14:06:03] DEBUG: 	repeat_graph_ovlp_divergence=0.05
[2023-08-29 14:06:03] DEBUG: 	read_align_ovlp_divergence=0.10
[2023-08-29 14:06:03] DEBUG: 	hpc_scoring_on=1
[2023-08-29 14:06:03] DEBUG: 	add_unassembled_reads=0
[2023-08-29 14:06:03] DEBUG: 	extend_contigs_with_repeats=0
[2023-08-29 14:06:03] DEBUG: 	min_read_cov_cutoff=3
[2023-08-29 14:06:03] DEBUG: 	short_tip_length=20000
[2023-08-29 14:06:03] DEBUG: 	long_tip_length=100000
[2023-08-29 14:06:03] DEBUG: Running with k-mer size: 17
[2023-08-29 14:06:03] DEBUG: Running with minimum overlap 2000
[2023-08-29 14:06:03] DEBUG: Metagenome mode: N
[2023-08-29 14:06:03] DEBUG: Short mode: N
[2023-08-29 14:06:03] INFO: Reading sequences
[2023-08-29 14:07:17] DEBUG: Building positional index
[2023-08-29 14:07:17] DEBUG: Total sequence: 5975507 bp
[2023-08-29 14:07:17] INFO: Building minimizer index
[2023-08-29 14:07:17] INFO: Pre-calculating index storage
[2023-08-29 14:07:18] DEBUG: Mean k-mer frequency: 3.64652
[2023-08-29 14:07:18] DEBUG: Repetitive k-mer frequency: 364
[2023-08-29 14:07:18] DEBUG: Filtered 0 repetitive k-mers (0)
[2023-08-29 14:07:18] INFO: Filling index
[2023-08-29 14:07:20] DEBUG: Sorting k-mer index
[2023-08-29 14:07:20] DEBUG: Selected k-mers: 545605
[2023-08-29 14:07:20] DEBUG: K-mer index size: 1989565
[2023-08-29 14:07:20] DEBUG: Mean k-mer frequency: 3.64653
[2023-08-29 14:07:20] DEBUG: Minimizer rate: 3.00342
[2023-08-29 14:07:20] DEBUG: Peak RAM usage: 0 Gb
[2023-08-29 14:07:20] DEBUG: Estimating k-mer identity bias
[2023-08-29 14:17:04] DEBUG: Initial divergence estimate : 0.0471071
[2023-08-29 14:17:04] DEBUG: Relative threshold: Y
[2023-08-29 14:17:04] DEBUG: Max divergence threshold set to 0.0971071
[2023-08-29 14:17:04] INFO: Extending reads
[2023-08-29 14:17:04] DEBUG: Estimating overlap coverage
[2023-08-29 14:20:09] INFO: Overlap-based coverage: 40
[2023-08-29 14:20:09] INFO: Median overlap divergence: 0.0512613
[2023-08-29 14:20:09] DEBUG: Sequence divergence distribution: 

    |       **          |                                                                                
    |       **          |                                                                                
    |       ***         |                                                                                
    |       ***         |                                                                                
    |      ****         |                                                                                
    |      ****         |                                                                                
    |      *****        |                                                                                
    |      *****        |                                                                                
    |      *****        |                                                                                
    |      ******       |                                                                                
    |      ****** *     |                                                                                
    |     **********  * |                                                                                
    |     **********  * |                                                                                
    |     **********  * |                                                                                
    |     ********** ** |                                                                                
    |     **************|                                                                                
    |     **************|                                                                                
    |     **************|*   *                                                                           
    |     ****************  ***                                                                          
    |     ***********************                                                                        
    ----------------------------------------------------------------------------------------------------
    0%        5%        10%       15%       20%       25%       30%       35%       40%       45%       

    Q25 = 0.039, Q50 = 0.051, Q75 = 0.071

[2023-08-29 14:20:10] DEBUG: Assembled disjointig 1
	With 14 reads
	Start read: +6fbefabf-6cfb-4e53-baa1-148b3dcfd615
	At position: 12
	leftTip: 1 rightTip: 1
	Suspicious: 2
	Short ext: 0
	Mean extensions: 28
	Avg overlap len: 57388
	Min overlap len: 49499
	Inner reads: 0
	Length: 128981
[2023-08-29 14:20:10] DEBUG: Inner: 162 covered: 174 total: 196
[2023-08-29 14:20:13] INFO: Assembled 1 disjointigs
[2023-08-29 14:20:13] INFO: Generating sequence
[2023-08-29 14:20:14] DEBUG: Building positional index
[2023-08-29 14:20:14] DEBUG: Total sequence: 129316 bp
[2023-08-29 14:20:14] DEBUG: Mean k-mer frequency: 1.00288
[2023-08-29 14:20:14] DEBUG: Repetitive k-mer frequency: 100
[2023-08-29 14:20:14] DEBUG: Filtered 0 repetitive k-mers (0)
[2023-08-29 14:20:14] DEBUG: Sorting k-mer index
[2023-08-29 14:20:14] DEBUG: Selected k-mers: 42983
[2023-08-29 14:20:14] DEBUG: K-mer index size: 43108
[2023-08-29 14:20:14] DEBUG: Mean k-mer frequency: 1.00291
[2023-08-29 14:20:14] DEBUG: Minimizer rate: 2.99981
[2023-08-29 14:20:14] INFO: Filtering contained disjointigs
[2023-08-29 14:20:14] DEBUG: Computing transitive closure for overlaps
[2023-08-29 14:20:14] DEBUG: Found 0 overlaps
[2023-08-29 14:20:14] DEBUG: Left 0 overlaps after filtering
[2023-08-29 14:20:14] INFO: Contained seqs: 0
[2023-08-29 14:20:14] DEBUG: Writing FASTA
[2023-08-29 14:20:14] DEBUG: Peak RAM usage: 0 Gb
-----------End assembly log------------
[2023-08-29 14:20:14] root: DEBUG: Disjointigs length: 129316, N50: 129316
[2023-08-29 14:20:14] root: INFO: >>>STAGE: consensus
[2023-08-29 14:20:14] root: INFO: Running Minimap2
[2023-08-29 14:24:27] root: INFO: Computing consensus
[2023-08-29 14:29:35] root: INFO: Alignment error rate: 0.057404
[2023-08-29 14:29:35] root: INFO: >>>STAGE: repeat
[2023-08-29 14:29:35] root: INFO: Building and resolving repeat graph
[2023-08-29 14:29:35] root: DEBUG: -----Begin repeat analyser log------
[2023-08-29 14:29:35] root: DEBUG: Running: flye-modules repeat --disjointigs /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/10-consensus/consensus.fasta --reads /home/giacomocastagnetti/code/rec_genome_analysis/data/nanopore/P2_C3.fastq.gz --out-dir /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/20-repeat --config /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_nano_hq.cfg --log /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/flye.log --threads 4 --min-ovlp 2000
[2023-08-29 14:29:35] DEBUG: Build date: May 16 2023 07:05:44
[2023-08-29 14:29:35] DEBUG: Total RAM: 31 Gb
[2023-08-29 14:29:35] DEBUG: Available RAM: 21 Gb
[2023-08-29 14:29:35] DEBUG: Total CPUs: 8
[2023-08-29 14:29:35] DEBUG: Loading /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_nano_hq.cfg
[2023-08-29 14:29:35] DEBUG: Loading /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_defaults.cfg
[2023-08-29 14:29:35] DEBUG: 	big_genome_threshold=29000000
[2023-08-29 14:29:35] DEBUG: 	meta_read_filter_kmer_freq=100
[2023-08-29 14:29:35] DEBUG: 	chain_large_gap_penalty=2
[2023-08-29 14:29:35] DEBUG: 	chain_small_gap_penalty=0.5
[2023-08-29 14:29:35] DEBUG: 	chain_gap_jump_threshold=100
[2023-08-29 14:29:35] DEBUG: 	max_coverage_drop_rate=5
[2023-08-29 14:29:35] DEBUG: 	max_extensions_drop_rate=5
[2023-08-29 14:29:35] DEBUG: 	chimera_window=100
[2023-08-29 14:29:35] DEBUG: 	chimera_overhang=1000
[2023-08-29 14:29:35] DEBUG: 	min_reads_in_disjointig=4
[2023-08-29 14:29:35] DEBUG: 	max_inner_reads=10
[2023-08-29 14:29:35] DEBUG: 	max_inner_fraction=0.25
[2023-08-29 14:29:35] DEBUG: 	max_separation=500
[2023-08-29 14:29:35] DEBUG: 	unique_edge_length=50000
[2023-08-29 14:29:35] DEBUG: 	min_repeat_res_support=0.51
[2023-08-29 14:29:35] DEBUG: 	out_paths_ratio=5
[2023-08-29 14:29:35] DEBUG: 	graph_cov_drop_rate=5
[2023-08-29 14:29:35] DEBUG: 	coverage_estimate_window=100
[2023-08-29 14:29:35] DEBUG: 	max_bubble_length=50000
[2023-08-29 14:29:35] DEBUG: 	loop_coverage_rate=1.5
[2023-08-29 14:29:35] DEBUG: 	repeat_edge_cov_mult=1.75
[2023-08-29 14:29:35] DEBUG: 	weak_detach_rate=5
[2023-08-29 14:29:35] DEBUG: 	tip_coverage_rate=2
[2023-08-29 14:29:35] DEBUG: 	tip_length_rate=2
[2023-08-29 14:29:35] DEBUG: 	output_gfa_before_rr=0
[2023-08-29 14:29:35] DEBUG: 	remove_alt_edges=0
[2023-08-29 14:29:35] DEBUG: 	low_cutoff_warning=0
[2023-08-29 14:29:35] DEBUG: 	kmer_size=17
[2023-08-29 14:29:35] DEBUG: 	use_minimizers=1
[2023-08-29 14:29:35] DEBUG: 	minimizer_window=5
[2023-08-29 14:29:35] DEBUG: 	reads_base_alignment=1
[2023-08-29 14:29:35] DEBUG: 	meta_read_top_kmer_rate=0.75
[2023-08-29 14:29:35] DEBUG: 	maximum_jump=1500
[2023-08-29 14:29:35] DEBUG: 	maximum_overhang=1500
[2023-08-29 14:29:35] DEBUG: 	repeat_kmer_rate=100
[2023-08-29 14:29:35] DEBUG: 	assemble_ovlp_divergence=0.05
[2023-08-29 14:29:35] DEBUG: 	assemble_divergence_relative=1
[2023-08-29 14:29:35] DEBUG: 	repeat_graph_ovlp_divergence=0.05
[2023-08-29 14:29:35] DEBUG: 	read_align_ovlp_divergence=0.10
[2023-08-29 14:29:35] DEBUG: 	hpc_scoring_on=1
[2023-08-29 14:29:35] DEBUG: 	add_unassembled_reads=0
[2023-08-29 14:29:35] DEBUG: 	extend_contigs_with_repeats=0
[2023-08-29 14:29:35] DEBUG: 	min_read_cov_cutoff=3
[2023-08-29 14:29:35] DEBUG: 	short_tip_length=20000
[2023-08-29 14:29:35] DEBUG: 	long_tip_length=100000
[2023-08-29 14:29:35] DEBUG: Running with k-mer size: 17
[2023-08-29 14:29:35] DEBUG: Selected minimum overlap 2000
[2023-08-29 14:29:35] DEBUG: Metagenome mode: N
[2023-08-29 14:29:35] INFO: Parsing disjointigs
[2023-08-29 14:29:35] DEBUG: Building positional index
[2023-08-29 14:29:35] DEBUG: Total sequence: 129409 bp
[2023-08-29 14:29:35] INFO: Building repeat graph
[2023-08-29 14:29:35] DEBUG: Mean k-mer frequency: 1.0038
[2023-08-29 14:29:35] DEBUG: Repetitive k-mer frequency: 100
[2023-08-29 14:29:35] DEBUG: Filtered 0 repetitive k-mers (0)
[2023-08-29 14:29:36] DEBUG: Sorting k-mer index
[2023-08-29 14:29:36] DEBUG: Selected k-mers: 42930
[2023-08-29 14:29:36] DEBUG: K-mer index size: 43094
[2023-08-29 14:29:36] DEBUG: Mean k-mer frequency: 1.00382
[2023-08-29 14:29:36] DEBUG: Minimizer rate: 3.00295
[2023-08-29 14:29:36] DEBUG: Computing transitive closure for overlaps
[2023-08-29 14:29:36] DEBUG: Found 0 overlaps
[2023-08-29 14:29:36] DEBUG: Left 0 overlaps after filtering
[2023-08-29 14:29:36] INFO: Median overlap divergence: 0
[2023-08-29 14:29:36] DEBUG: Sequence divergence distribution: 

    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    |          |                                                                                         
    ----------------------------------------------------------------------------------------------------
    0%        5%        10%       15%       20%       25%       30%       35%       40%       45%       

    Q25 = 0, Q50 = 0, Q75 = 0

[2023-08-29 14:29:36] DEBUG: Computing gluepoints
[2023-08-29 14:29:36] DEBUG: Added 0 gluepoint projections
[2023-08-29 14:29:36] DEBUG: Created 4 gluepoints
[2023-08-29 14:29:36] DEBUG: Artificial loops removed: 0 left, 0 right, 0 both
[2023-08-29 14:29:36] DEBUG: Initializing edges
[2023-08-29 14:29:36] DEBUG: Edges length checksum: 18446744073276112896
[2023-08-29 14:29:36] DEBUG: Filtered 0 singleton segments
[2023-08-29 14:29:36] DEBUG: Removed 0 simple and 0 double chimeric junctions
[2023-08-29 14:29:36] DEBUG: Collapsed 0 edges
[2023-08-29 14:29:36] DEBUG: *	1	+disjointig_1	0	129408	129408	
[2023-08-29 14:29:36] DEBUG: Total edges: 1
[2023-08-29 14:29:36] INFO: Parsing reads
[2023-08-29 14:30:00] DEBUG: Building positional index
[2023-08-29 14:30:00] DEBUG: Total sequence: 850958223 bp
[2023-08-29 14:30:00] DEBUG: Building positional index
[2023-08-29 14:30:00] DEBUG: Total sequence: 129408 bp
[2023-08-29 14:30:00] INFO: Aligning reads to the graph
[2023-08-29 14:30:00] DEBUG: Mean k-mer frequency: 1.0038
[2023-08-29 14:30:00] DEBUG: Repetitive k-mer frequency: 100
[2023-08-29 14:30:00] DEBUG: Filtered 0 repetitive k-mers (0)
[2023-08-29 14:30:00] DEBUG: Sorting k-mer index
[2023-08-29 14:30:00] DEBUG: Selected k-mers: 42930
[2023-08-29 14:30:00] DEBUG: K-mer index size: 43094
[2023-08-29 14:30:00] DEBUG: Mean k-mer frequency: 1.00382
[2023-08-29 14:30:00] DEBUG: Minimizer rate: 3.00292
[2023-08-29 14:32:13] DEBUG: Total reads : 111133
[2023-08-29 14:32:13] DEBUG: Read with aligned parts : 109300
[2023-08-29 14:32:13] DEBUG: Aligned in one piece : 108853
[2023-08-29 14:32:13] INFO: Aligned read sequence: 755267720 / 771487442 (0.978976)
[2023-08-29 14:32:13] INFO: Median overlap divergence: 0.0240092
[2023-08-29 14:32:13] DEBUG: Sequence divergence distribution: 

    |   *                |                                                                               
    |   **               |                                                                               
    |   **               |                                                                               
    |   **               |                                                                               
    |   **               |                                                                               
    |   **               |                                                                               
    |   **               |                                                                               
    |   ***              |                                                                               
    |   ***              |                                                                               
    |   ***              |                                                                               
    |  ****              |                                                                               
    |  *****             |                                                                               
    |  *****             |                                                                               
    |  *****             |                                                                               
    |  ******            |                                                                               
    |  ******            |                                                                               
    |  *******           |                                                                               
    |  *********         |                                                                               
    | *************      |                                                                               
    |************************************ ***    *    *  *   * *   *     *  *  *                         
    ----------------------------------------------------------------------------------------------------
    0%        5%        10%       15%       20%       25%       30%       35%       40%       45%       

    Q25 = 0.018, Q50 = 0.024, Q75 = 0.034

[2023-08-29 14:32:13] INFO: Mean edge coverage: 5776
[2023-08-29 14:32:13] DEBUG: 1	len:129408	cov:5748	mult:0.995152
[2023-08-29 14:32:13] DEBUG: -1	len:129408	cov:5748	mult:0.995152
[2023-08-29 14:32:13] DEBUG: Unique coverage threshold 10059
[2023-08-29 14:32:13] INFO: Simplifying the graph
[2023-08-29 14:32:13] DEBUG: Read coverage cutoff: 1155
[2023-08-29 14:32:13] DEBUG: [SIMPL] Removed 0 paths with low coverage
[2023-08-29 14:32:13] DEBUG: [SIMPL] Masked 0 heterozygous loops
[2023-08-29 14:32:13] DEBUG: [SIMPL] Masked 0 simple bubbles
[2023-08-29 14:32:13] DEBUG: Finding repeats
[2023-08-29 14:32:13] DEBUG: Read coverage cutoff: 1155
[2023-08-29 14:32:13] DEBUG: Repeat detection iteration 1
[2023-08-29 14:32:13] DEBUG: Writing Dot
[2023-08-29 14:32:13] DEBUG: Writing FASTA
[2023-08-29 14:32:13] DEBUG: [SIMPL] == Iteration 1 ==
[2023-08-29 14:32:13] DEBUG: Splitting nodes
[2023-08-29 14:32:13] DEBUG: [SIMPL] Split 0 nodes
[2023-08-29 14:32:13] DEBUG: [SIMPL] Clipped 0 short and 0 long tips
[2023-08-29 14:32:13] DEBUG: [SIMPL] Masked 0 heterozygous loops
[2023-08-29 14:32:13] DEBUG: [SIMPL] Masked 0 simple bubbles
[2023-08-29 14:32:13] DEBUG: Finding repeats
[2023-08-29 14:32:13] DEBUG: Read coverage cutoff: 1155
[2023-08-29 14:32:13] DEBUG: Repeat detection iteration 1
[2023-08-29 14:32:13] DEBUG: Total unique edges: 1
[2023-08-29 14:32:13] DEBUG: [SIMPL] Resolved repeats: 0
[2023-08-29 14:32:13] DEBUG: RR links: 0
[2023-08-29 14:32:13] DEBUG: Unresolved: 0
[2023-08-29 14:32:13] DEBUG: Removed 0 simple and 0 double chimeric junctions
[2023-08-29 14:32:13] DEBUG: [SIMPL] Collapsed 0 haplotypes
[2023-08-29 14:32:13] DEBUG: [SIMPL] Resolved 0 simple repeats
[2023-08-29 14:32:13] DEBUG: Read coverage cutoff: 1155
[2023-08-29 14:32:13] DEBUG: [SIMPL] Removed 0 paths with low coverage
[2023-08-29 14:32:13] DEBUG: Finding repeats
[2023-08-29 14:32:13] DEBUG: Read coverage cutoff: 1155
[2023-08-29 14:32:13] DEBUG: Repeat detection iteration 1
[2023-08-29 14:32:13] DEBUG: Writing Dot
[2023-08-29 14:32:14] DEBUG: Writing FASTA
[2023-08-29 14:32:14] DEBUG: Peak RAM usage: 0 Gb
-----------End assembly log------------
[2023-08-29 14:32:14] root: INFO: >>>STAGE: contigger
[2023-08-29 14:32:14] root: INFO: Generating contigs
[2023-08-29 14:32:14] root: DEBUG: -----Begin contigger analyser log------
[2023-08-29 14:32:14] root: DEBUG: Running: flye-modules contigger --graph-edges /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/20-repeat/repeat_graph_edges.fasta --reads /home/giacomocastagnetti/code/rec_genome_analysis/data/nanopore/P2_C3.fastq.gz --out-dir /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/30-contigger --config /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_nano_hq.cfg --repeat-graph /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/20-repeat/repeat_graph_dump --graph-aln /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/20-repeat/read_alignment_dump --log /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/flye.log --threads 4 --min-ovlp 2000
[2023-08-29 14:32:14] DEBUG: Build date: May 16 2023 07:06:14
[2023-08-29 14:32:14] DEBUG: Total RAM: 31 Gb
[2023-08-29 14:32:14] DEBUG: Available RAM: 20 Gb
[2023-08-29 14:32:14] DEBUG: Total CPUs: 8
[2023-08-29 14:32:14] DEBUG: Loading /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_nano_hq.cfg
[2023-08-29 14:32:14] DEBUG: Loading /home/giacomocastagnetti/code/rec_genome_analysis/.snakemake/conda/9f47a5efe248dbe04a41f86aa0444c17/lib/python3.9/site-packages/flye/config/bin_cfg/asm_defaults.cfg
[2023-08-29 14:32:14] DEBUG: 	big_genome_threshold=29000000
[2023-08-29 14:32:14] DEBUG: 	meta_read_filter_kmer_freq=100
[2023-08-29 14:32:14] DEBUG: 	chain_large_gap_penalty=2
[2023-08-29 14:32:14] DEBUG: 	chain_small_gap_penalty=0.5
[2023-08-29 14:32:14] DEBUG: 	chain_gap_jump_threshold=100
[2023-08-29 14:32:14] DEBUG: 	max_coverage_drop_rate=5
[2023-08-29 14:32:14] DEBUG: 	max_extensions_drop_rate=5
[2023-08-29 14:32:14] DEBUG: 	chimera_window=100
[2023-08-29 14:32:14] DEBUG: 	chimera_overhang=1000
[2023-08-29 14:32:14] DEBUG: 	min_reads_in_disjointig=4
[2023-08-29 14:32:14] DEBUG: 	max_inner_reads=10
[2023-08-29 14:32:14] DEBUG: 	max_inner_fraction=0.25
[2023-08-29 14:32:14] DEBUG: 	max_separation=500
[2023-08-29 14:32:14] DEBUG: 	unique_edge_length=50000
[2023-08-29 14:32:14] DEBUG: 	min_repeat_res_support=0.51
[2023-08-29 14:32:14] DEBUG: 	out_paths_ratio=5
[2023-08-29 14:32:14] DEBUG: 	graph_cov_drop_rate=5
[2023-08-29 14:32:14] DEBUG: 	coverage_estimate_window=100
[2023-08-29 14:32:14] DEBUG: 	max_bubble_length=50000
[2023-08-29 14:32:14] DEBUG: 	loop_coverage_rate=1.5
[2023-08-29 14:32:14] DEBUG: 	repeat_edge_cov_mult=1.75
[2023-08-29 14:32:14] DEBUG: 	weak_detach_rate=5
[2023-08-29 14:32:14] DEBUG: 	tip_coverage_rate=2
[2023-08-29 14:32:14] DEBUG: 	tip_length_rate=2
[2023-08-29 14:32:14] DEBUG: 	output_gfa_before_rr=0
[2023-08-29 14:32:14] DEBUG: 	remove_alt_edges=0
[2023-08-29 14:32:14] DEBUG: 	low_cutoff_warning=0
[2023-08-29 14:32:14] DEBUG: 	kmer_size=17
[2023-08-29 14:32:14] DEBUG: 	use_minimizers=1
[2023-08-29 14:32:14] DEBUG: 	minimizer_window=5
[2023-08-29 14:32:14] DEBUG: 	reads_base_alignment=1
[2023-08-29 14:32:14] DEBUG: 	meta_read_top_kmer_rate=0.75
[2023-08-29 14:32:14] DEBUG: 	maximum_jump=1500
[2023-08-29 14:32:14] DEBUG: 	maximum_overhang=1500
[2023-08-29 14:32:14] DEBUG: 	repeat_kmer_rate=100
[2023-08-29 14:32:14] DEBUG: 	assemble_ovlp_divergence=0.05
[2023-08-29 14:32:14] DEBUG: 	assemble_divergence_relative=1
[2023-08-29 14:32:14] DEBUG: 	repeat_graph_ovlp_divergence=0.05
[2023-08-29 14:32:14] DEBUG: 	read_align_ovlp_divergence=0.10
[2023-08-29 14:32:14] DEBUG: 	hpc_scoring_on=1
[2023-08-29 14:32:14] DEBUG: 	add_unassembled_reads=0
[2023-08-29 14:32:14] DEBUG: 	extend_contigs_with_repeats=0
[2023-08-29 14:32:14] DEBUG: 	min_read_cov_cutoff=3
[2023-08-29 14:32:14] DEBUG: 	short_tip_length=20000
[2023-08-29 14:32:14] DEBUG: 	long_tip_length=100000
[2023-08-29 14:32:14] DEBUG: Running with k-mer size: 17
[2023-08-29 14:32:14] DEBUG: Selected minimum overlap 2000
[2023-08-29 14:32:14] INFO: Reading sequences
[2023-08-29 14:32:34] DEBUG: Building positional index
[2023-08-29 14:32:34] DEBUG: Total sequence: 850958223 bp
[2023-08-29 14:32:35] DEBUG: Flipped 0
[2023-08-29 14:32:35] DEBUG: UPath 1: 1
[2023-08-29 14:32:35] DEBUG: Final graph contains 1 egdes
[2023-08-29 14:32:35] DEBUG: Extending contigs into repeats
[2023-08-29 14:32:35] DEBUG: Covered 0 repetitive contigs
[2023-08-29 14:32:35] INFO: Generated 1 contigs
[2023-08-29 14:32:35] DEBUG: Writing FASTA
[2023-08-29 14:32:35] DEBUG: Generating scaffold connections
[2023-08-29 14:32:35] INFO: Added 0 scaffold connections
[2023-08-29 14:32:35] DEBUG: Writing Dot
[2023-08-29 14:32:35] DEBUG: Writing FASTA
[2023-08-29 14:32:35] DEBUG: Writing Gfa
[2023-08-29 14:32:35] DEBUG: Peak RAM usage: 0 Gb
-----------End assembly log------------
[2023-08-29 14:32:35] root: INFO: >>>STAGE: polishing
[2023-08-29 14:32:35] root: INFO: Polishing genome (1/1)
[2023-08-29 14:32:35] root: INFO: Running minimap2
[2023-08-29 14:35:50] root: INFO: Separating alignment into bubbles
[2023-08-29 14:37:52] root: DEBUG: Generated 8531 bubbles
[2023-08-29 14:37:52] root: DEBUG: Split 0 long bubbles
[2023-08-29 14:37:52] root: DEBUG: Skipped 0 empty bubbles
[2023-08-29 14:37:52] root: DEBUG: Skipped 0 bubbles with long branches
[2023-08-29 14:37:52] root: INFO: Alignment error rate: 0.032770
[2023-08-29 14:37:52] root: INFO: Correcting bubbles
[2023-08-29 14:37:53] root: DEBUG: Mean contig coverage: 6455, selected threshold: 1291
[2023-08-29 14:37:53] root: DEBUG: Filtered 0 contigs of total length 0
[2023-08-29 14:37:53] root: DEBUG: Generating polished GFA
[2023-08-29 14:37:53] root: DEBUG: 0 sequences remained unpolished
[2023-08-29 14:37:53] root: INFO: >>>STAGE: finalize
[2023-08-29 14:37:53] root: DEBUG: ---Output dir contents:----
[2023-08-29 14:37:53] root: DEBUG: C3_flye/
[2023-08-29 14:37:53] root: DEBUG:     126.0 K     assembly_graph.gfa
[2023-08-29 14:37:53] root: DEBUG:     29.0 K      flye.log
[2023-08-29 14:37:53] root: DEBUG:     128.0 K     assembly.fasta
[2023-08-29 14:37:53] root: DEBUG:     96.0 B      params.json
[2023-08-29 14:37:53] root: DEBUG:     371.0 B     assembly_graph.gv
[2023-08-29 14:37:53] root: DEBUG:     10-consensus/
[2023-08-29 14:37:53] root: DEBUG:         128.0 K     consensus.fasta
[2023-08-29 14:37:53] root: DEBUG:         1007.0 B    minimap.stderr
[2023-08-29 14:37:53] root: DEBUG:         270.0 K     minimap.bam.bai
[2023-08-29 14:37:53] root: DEBUG:     20-repeat/
[2023-08-29 14:37:53] root: DEBUG:         371.0 B     graph_after_rr.gv
[2023-08-29 14:37:53] root: DEBUG:         127.0 K     graph_before_rr.fasta
[2023-08-29 14:37:53] root: DEBUG:         127.0 K     repeat_graph_edges.fasta
[2023-08-29 14:37:53] root: DEBUG:         371.0 B     graph_before_rr.gv
[2023-08-29 14:37:53] root: DEBUG:         28.0 M      read_alignment_dump
[2023-08-29 14:37:53] root: DEBUG:         187.0 B     repeat_graph_dump
[2023-08-29 14:37:53] root: DEBUG:     30-contigger/
[2023-08-29 14:37:53] root: DEBUG:         127.0 K     graph_final.fasta
[2023-08-29 14:37:53] root: DEBUG:         127.0 K     contigs.fasta
[2023-08-29 14:37:53] root: DEBUG:         25.0 B      contigs.fasta.fai
[2023-08-29 14:37:53] root: DEBUG:         0.0 B       scaffolds_links.txt
[2023-08-29 14:37:53] root: DEBUG:         371.0 B     graph_final.gv
[2023-08-29 14:37:53] root: DEBUG:         113.0 B     contigs_stats.txt
[2023-08-29 14:37:53] root: DEBUG:         126.0 K     graph_final.gfa
[2023-08-29 14:37:53] root: DEBUG:     40-polishing/
[2023-08-29 14:37:53] root: DEBUG:         38.0 K      base_coverage.bed.gz
[2023-08-29 14:37:53] root: DEBUG:         261.0 K     minimap_1.bam.bai
[2023-08-29 14:37:53] root: DEBUG:         128.0 K     filtered_contigs.fasta
[2023-08-29 14:37:53] root: DEBUG:         968.0 B     minimap.stderr
[2023-08-29 14:37:53] root: DEBUG:         25.0 B      filtered_contigs.fasta.fai
[2023-08-29 14:37:53] root: DEBUG:         152.0 B     edges_aln.bam.bai
[2023-08-29 14:37:53] root: DEBUG:         47.0 B      contigs_stats.txt
[2023-08-29 14:37:53] root: DEBUG:         47.0 B      filtered_stats.txt
[2023-08-29 14:37:53] root: DEBUG:         126.0 K     polished_edges.gfa
[2023-08-29 14:37:53] root: DEBUG:     00-assembly/
[2023-08-29 14:37:53] root: DEBUG:         127.0 K     draft_assembly.fasta
[2023-08-29 14:37:53] root: DEBUG:         29.0 B      draft_assembly.fasta.fai
[2023-08-29 14:37:53] root: DEBUG: --------------------------
[2023-08-29 14:37:53] root: INFO: Assembly statistics:

	Total length:	129419
	Fragments:	1
	Fragments N50:	129419
	Largest frg:	129419
	Scaffolds:	0
	Mean coverage:	6455

[2023-08-29 14:37:53] root: INFO: Final assembly: /home/giacomocastagnetti/code/rec_genome_analysis/results/assemblies/P2/C3_flye/assembly.fasta
